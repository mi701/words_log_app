# アプリ「Log.」設計指針（blueprint.md）

このドキュメントは、アプリ「Log.」の核となる哲学と、絶対に削除してはいけない機能を定義したものである。コードの改変・リファクタリングを行う際は、常にこの指針を遵守すること。

## 1. 基本理念（凪 - Nagi）
- **評価しない**: ユーザーを褒めもしないし、叱りもしない。
- **責めさせない**: 記録がない日を「欠陥」ではなく「静かな時間の気配」として描く。
- **ただ置く**: 考えることと書くことを分離し、単語をキャンバスに置く手応えだけを報酬とする。

## 2. 視覚的ルール（佇まい）
- **配色**: 
  - ライト：古紙色（#F2F0EB）。真っ白は「書く圧力」を生むため禁止。
  - ダーク：深い夜（#1A1B1E）。没入感を高め、視覚的なノイズを消す。
- **フォント**: 明朝体（Serif）は禁止。清潔なサンセリフ（ゴシック体）のみ。
- **引き算の美学**: ボタンの枠線、境界線、過剰な装飾は極力排除する。操作ではなく「視点の移行」を目指す。

## 3. 必須機能チェックリスト（削除厳禁）
リファクタリング時、以下の機能がコード内に維持されているか必ず確認すること。

- **記録タブ**
  - AIのひらめき（Gemini API連携。Markdown装飾の除去ロジックを含む）。この部分は今正常に動いているので一切変更を加えないで。
  - ポケット（ユーザー辞書。追加・削除・永続化）。
  - 1画面スクロール構造（全要素が同一のスクロールエリアに収まること）。
- **観察タブ**
  - ことばの跡（旧LOGS。抽出・堆積のモード切替。未選択側の透明度は30%以下に）。
  - 足あと（28日間のグリッド表示）。
  - ひろった小石（中央に配置。クリックでランダムに入れ替わる、点滅しない滑らかなアニメーション）。
  - 時の気配（Atmosphere。記録がない時間に比例した高さと透明度のオーラ。2日以上限定のif文は廃止）。
  - 4つのオーラ切替（温・清・夢・無。夢は多色アニメーション、マスクによるふちのぼかし）。
- **設定タブ**
  - バックアップ（Export）と復元（Import）機能。
  - 日本語ラベル（システム、見た目、データの管理、全ての記録を消去する）。
- **システム**
  - PWA対応（manifest.jsonへのリンク、standalone起動設定）。

## 4. テクニカル・ガードレール
- **エラーハンドリング**: AIの応答が不正な場合でも、`Array.isArray` 等でチェックし、アプリ全体をクラッシュさせない。
- **シングルファイル**: 原則として `index.html` 一枚で完結する。
- **不透明度の調整**: ダークモードでの発光感は `opacity-5` 〜 `15` 程度の極薄い設定を維持し、目に痛くないようにする。